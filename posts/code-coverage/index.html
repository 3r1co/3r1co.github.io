<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=generator content="Hugo 0.85.0"><title>Code Coverage with TomEE, JaCoCo and SonarQube &#183; 3r1.co</title><link rel="shortcut icon" href=https://3r1co.github.io/images/favicon.ico><link rel=stylesheet href=https://3r1co.github.io/css/style.css><link rel=stylesheet href=https://3r1co.github.io/css/highlight.css><link rel=stylesheet href=https://3r1co.github.io/css/monosocialiconsfont.css></head><body><nav class=main-nav><a href=https://3r1co.github.io/><span class=arrow>←</span>Home</a>
<a href=https://3r1co.github.io/posts>Archive</a>
<a href=https://3r1co.github.io/tags>Tags</a>
<a href=https://3r1co.github.io/about>About</a></nav><section id=wrapper class=post><article><header><h1>Code Coverage with TomEE, JaCoCo and SonarQube</h1><h2 class=headline>Feb 8, 2017 14:53
· 187 words
· 1 minute read
<span class=tags></span></h2></header><section id=post-body><p>Recently we were facing the challenge how to integrate code coverage analysis for functional tests in our continuous delivery process.</p><p>We were already using JaCoCo before, but checking on the internet I never found one simple example to start from scratch. So I decided to publish one <a href=https://github.com/3r1co/jacoco>here</a>.</p><p>Despite the documentation is quite heavy, it is actually really simple to integrate code coverage analysis in your environment (in the example we are using a TomEE Container).</p><p>Two things are important:</p><ol><li><p>You need to provide the JaCoCo Agent, which you can download <a href="http://search.maven.org/remotecontent?filepath=org/jacoco/jacoco/0.7.9/jacoco-0.7.9.zip">here</a>.
In the example, we mount the agent from outside into the Docker container. That way, we don&rsquo;t need to deliver the agent in the production image.</p></li><li><p>You need to modify the JAVA_OPTS environment variable to tell your server that a Java Agent is running:</p></li></ol><pre><code>JAVA_OPTS=-javaagent:/jacocoagent.jar=output=tcpserver,address=*
</code></pre><p>Afterwards you can retrieve the JaCoCo Dump with maven with:</p><pre><code>mvn jacoco:dump -Djacoco.address=&lt;hostname of your server&gt;
</code></pre><p>And publish the result to SonarQube, which will do the coverage computation:</p><pre><code>mvn sonar:sonar -Dsonar.host.url=http://&lt;hostname of sonarqube&gt;:9000
</code></pre><p>I hope this little example helps one or the another who is struggeling with the same issues.</p></section></article><footer id=footer><p class=small>© Copyright 2021 <i class="fa fa-heart" aria-hidden=true></i></p><p class=small>Powered by <a href=http://www.gohugo.io/>Hugo</a> Theme By <a href=https://github.com/nodejh/hugo-theme-cactus-plus>nodejh</a></p></footer></section><script src=https://3r1co.github.io/js/jquery-3.3.1.min.js></script><script src=https://3r1co.github.io/js/main.js></script><script src=https://3r1co.github.io/js/highlight.min.js></script><script>hljs.initHighlightingOnLoad()</script></body></html>